<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>2048</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="manifest" href="site.webmanifest">
        <link rel="apple-touch-icon" href="icon.png">
        <!-- Place favicon.ico in the root directory -->

        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">
        <style type="text/css">
            #container {
                width: 100%;
                height: 100%;
                position: absolute;
                left: 25rem;

            }
            #outFrame{
                display:flex;
                flex-flow: row wrap;
                justify-content: space-around;
                align-items: center;
                width: 400px;
                height: 400px;
                background-color: burlywood;
                border: 1px solid transparent;
                border-radius: 5px;
            }
            #gameStart{
                margin: 0;
                padding: 0;
                outline: none;
                width: 100px;
                height: 30px;
                line-height: 30px;
                text-align: center;
                background-color: orangered;
                border:1px solid transparent;
                border-radius: 20px;
                color: white;
            }
            #gameReplace{
                margin: 0 0 0 190px;
                padding: 0;
                outline: none;
                width: 100px;
                height: 30px;
                line-height: 30px;
                text-align: center;
                background-color: dodgerblue;
                border:1px solid transparent;
                border-radius: 20px;
                color: white;
            }
            #gameScore{
                position: relative;
                line-height: 25px;
                left: 150px;
                width: 100px;
                height: 50px;
                margin: 5px;
                text-align: center;
                background-color: chocolate;
                color: white;
                border: 1px solid transparent;
                border-radius: 5px;

            }
            .inFrame{
                position: relative;
                width: 90px;
                height: 90px;
                background-color: antiquewhite;
                border: 1px solid transparent;
                border-radius: 5px;
                color: black;
                font-size: 35px;
                text-align: center;
                line-height: 90px;
                transition: 1s;

            }
            #rules{
                margin-top: 10px;
                width: 400px;
                height: 200px;
            }

        </style>
    </head>
    <body>
    <!--主容器用于存放2048框-->
        <div id="container">
            <!--存放得分-->
            <div id="gameScore">
                <div><span>得分</span><br/><span>2048</span></div>

            </div>
            <!--存放开始和重置按钮-->
            <div style="margin: 5px">
                <button id="gameStart">开始游戏</button>
                <button id="gameReplace">重置游戏</button>
            </div>
            <!--2048外框-->
            <div id="outFrame">
                <!--内框-->
                <div class="inFrame" ></div>
                <div class="inFrame" ></div>
                <div class="inFrame" ></div>
                <div class="inFrame" ></div>
                <div class="inFrame" ></div>
                <div class="inFrame" ></div>
                <div class="inFrame" ></div>
                <div class="inFrame" ></div>
                <div class="inFrame" ></div>
                <div class="inFrame" ></div>
                <div class="inFrame" ></div>
                <div class="inFrame" ></div>
                <div class="inFrame" ></div>
                <div class="inFrame" ></div>
                <div class="inFrame" ></div>
                <div class="inFrame" ></div>
            </div>
            <div id="rules"><span>游戏规则：使用wsad控制滑块上下左右移动，2048游戏共有16个格子，初始时会有两个格子上安放了两个数字2，每次可以选择上下左右其中一个方向去滑动，每滑动一次，所有的数字方块都会往滑动的方向靠拢外，系统也会在空白的地方随即出现一个数字方块，相同数字的方块在靠拢、相撞时会相加。系统给予的数字方块不是2就是4，玩家要想办法在这小小的16格范围中凑出“2048”这个数字方块。</span>
            </div>

        </div>
        <script src="js/vendor/modernizr-3.5.0.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-3.2.1.min.js"><\/script>')</script>
        <script src="js/plugins.js"></script>
        <script src="js/main.js"></script>
        <script>
            //全局变量，少用（无法回收）,存取了DOM（.inFrame）
            var inFrame=$(".inFrame");
            //函数体，封装主体
            function Game2048() {

            }
            //定义原型方法
            Game2048.prototype={
                //开始游戏
                gameStart:function () {
                    var num1=Math.floor(Math.random()*16);
                    var num2=Math.floor(Math.random()*16);
                    //判断重复
                    if(num1!=num2) {
                        inFrame.eq(num1).html("2");
                        inFrame.eq(num2).html("2");
                    }
                    else {
                        return this.gameStart();
                    }
                    //给数字上色
                    changeColor();

                },
                gameReplace:function() {
                    var inframe=$(".inFrame");
                    for(var i=0;i<16;i++)
                    {
                        inframe.eq(i).html("");
                    }
                    frag=0;
                    changeColor();

                }


            };
            var game=new Game2048();


            //判断数，给不同的数加不同颜色
            function changeColor() {
                var inframe=$(".inFrame");
                for(var i=0;i<16;i++)
                {
                    switch (inframe.eq(i).html())
                    {
                        case "2":inframe.eq(i).css("background","#D2A47D");
                            break;
                        case "4":inframe.eq(i).css("background","#D29E5F");
                            break;
                        case "8":inframe.eq(i).css("background","#FAC25B");
                            break;
                        case "16":inframe.eq(i).css("background","#FABA48");
                            break;
                        case "32":inframe.eq(i).css("background","#FA9738");
                            break;
                        case "64":inframe.eq(i).css("background","#FA8B31");
                            break;
                        case "128":inframe.eq(i).css("background","#FA7322");
                            break;
                        case "256":inframe.eq(i).css("background","#FA5A11");
                            break;
                        case "512":inframe.eq(i).css("background","#FA4E21");
                            break;
                        case "1024":inframe.eq(i).css("background","#FA3B19");
                            break;
                        case "2048":inframe.eq(i).css("background","#FA2914");
                            break;
                        default:inframe.eq(i).css("background","antiquewhite");
                    }
                }

            }
            //点击开始时，生成随机两个位置2
            /*unction gameStart() {
                        var num1=Math.floor(Math.random()*16);
                        var num2=Math.floor(Math.random()*16);
                        var inFrame = document.getElementsByClassName("inFrame");
                        //判断重复
                        if(num1!=num2) {
                            inFrame[num1].innerHTML = "2";
                            inFrame[num2].innerHTML = "2";
                        }
                        else {
                            return gameStart();
                        }
                         //给数字上色
                        changeColor();

            }*/
            var frag=0;
            $("#gameStart").click(function () {
                //判断是否二次点击开始游戏
                frag++;
                if(frag==1)
                {
                    game.gameStart();
                }
                else {
                    alert("游戏已经开始");
                }
            });
            //游戏重置
            function gameReplace() {
                var inframe=$(".inFrame");
                for(var i=0;i<16;i++)
                {
                    inframe.eq(i).html("");
                }
                frag=0;
                changeColor();

            }
            $("#gameReplace").click(function () {
                gameReplace();

            });
            //随机生成数
            function createBox() {
                var num=Math.floor(Math.random()*16);
                var inFrame=$(".inFrame");
                if(inFrame.eq(num).html()=="")
                {
                    inFrame.eq(num).html("2");
                    changeColor();
                }
                else {
                    return createBox();
                }
            }
            //交换Box位置
            function changeOrder(a,b) {
                var outFrame = $("#outFrame");
                var arr=outFrame.find("div").toArray();
                var temp;//用于处理临时变量
                temp=arr[a];
                arr[a]=arr[b];
                arr[b]=temp;
                outFrame.html(arr);
            }
            //相同数结合
            function getAdd(a,b) {


            }
            //游戏开始事件绑定
            //w事件
           function keyCodeW() {
               if(frag==1)//判断游戏是否开始
               {
                   var inFrame = $(".inFrame");
                   //判断是否有数
                   for (var i = 4; i < 16; i++) {
                       if(i>3&&i<8&&inFrame.eq(i-4).html()==""&&inFrame.eq(i).html()!="")
                       {
                           changeOrder(i,i-4);
                       }
                       if(i>7&&i<12&&inFrame.eq(i-4).html()==""&&inFrame.eq(i).html()!="")
                       {
                           if(inFrame.eq(i-8).html()=="")
                           {
                               changeOrder(i,i-8);
                           }
                           else {
                               changeOrder(i,i-4);
                           }
                       }
                       if(i>7&&i<12&&inFrame.eq(i-4).html()!=""&&inFrame.eq(i).html()!="")
                       {
                           if(inFrame.eq(i-8).html()=="")
                           {
                               changeOrder(i,i-4);
                           }
                       }
                       if(i>11&&i<16&&inFrame.eq(i-4).html()==""&&inFrame.eq(i).html()!="")
                       {
                           if(inFrame.eq(i-8).html()==""&&inFrame.eq(i-12).html()=="")
                           {
                               changeOrder(i,i-12);
                           }
                           else if(inFrame.eq(i-8).html()=="")
                           {
                               changeOrder(i,i-8);
                           }
                           else if(inFrame.eq(i-8).html()!=""&&inFrame.eq(i-12).html()=="")
                           {
                               changeOrder(i,i-8);
                           }
                           else if(inFrame.eq(i-8).html()!=""&&inFrame.eq(i-12).html()!="")
                           {
                               changeOrder(i,i-4);
                           }
                       }

                       if(i>11&&i<16&&inFrame.eq(i-4).html()!=""&&inFrame.eq(i).html()!="")
                       {
                           if(inFrame.eq(i-8).html()==""&&inFrame.eq(i-12).html()=="")
                           {
                               changeOrder(i,i-8);
                           }
                           else if(inFrame.eq(i-8).html()!=""&&inFrame.eq(i-12).html()=="")
                           {
                               changeOrder(i,i-4);
                           }
                           else if(inFrame.eq(i-8).html()==""&&inFrame.eq(i-12).html()!="")
                           {
                               changeOrder(i,i-4);
                           }
                       }

                   }
                   createBox();//随机生成盒子
               }}
               //s事件
            function keyCodeS() {
                if(frag==1)//判断游戏是否开始
                {
                    var inFrame = $(".inFrame");
                    //判断是否有数
                    for (var i = 11; i > -1; i--) {
                        if(i>7&&i<12&&inFrame.eq(i+4).html()==""&&inFrame.eq(i).html()!="")
                        {
                            changeOrder(i,i+4);
                        }
                        if(i>3&&i<8&&inFrame.eq(i+4).html()==""&&inFrame.eq(i).html()!="")
                        {
                            if(inFrame.eq(i+8).html()=="")
                            {
                                changeOrder(i,i+8);
                            }
                            else {
                                changeOrder(i,i+4);
                            }
                        }
                        if(i>3&&i<8&&inFrame.eq(i+4).html()!=""&&inFrame.eq(i).html()!="")
                        {
                            if(inFrame.eq(i+8).html()=="")
                            {
                                changeOrder(i,i+4);
                            }
                        }
                        if(i>-1&&i<4&&inFrame.eq(i+4).html()==""&&inFrame.eq(i).html()!="")
                        {
                            if(inFrame.eq(i+8).html()==""&&inFrame.eq(i+12).html()=="")
                            {
                                changeOrder(i,i+12);
                            }
                            else if(inFrame.eq(i+8).html()=="")
                            {
                                changeOrder(i,i+8);
                            }
                            else if(inFrame.eq(i+8).html()!=""&&inFrame.eq(i+12).html()=="")
                            {
                                changeOrder(i,i+8);
                            }
                            else if(inFrame.eq(i+8).html()!=""&&inFrame.eq(i+12).html()!="")
                            {
                                changeOrder(i,i+4);
                            }
                        }

                        if(i>-1&&i<4&&inFrame.eq(i+4).html()!=""&&inFrame.eq(i).html()!="")
                        {
                            if(inFrame.eq(i+8).html()==""&&inFrame.eq(i+12).html()=="")
                            {
                                changeOrder(i,i+8);
                            }
                            else if(inFrame.eq(i+8).html()!=""&&inFrame.eq(i+12).html()=="")
                            {
                                changeOrder(i,i+4);
                            }
                            else if(inFrame.eq(i+8).html()==""&&inFrame.eq(i+12).html()!="")
                            {
                                changeOrder(i,i+4);
                            }
                        }

                    }
                    createBox();//随机生成盒子
                }}
                //A事件
            function keyCodeA() {
                if(frag==1)//判断游戏是否开始
                {
                    var inFrame = $(".inFrame");
                    //判断是否有数
                    for(var i=0;i<16;i++)
                    {
                        if(i==1||i==5||i==9||i==13)//第二列
                        {
                            if(inFrame.eq(i).html()!=""&&inFrame.eq(i-1).html()=="")
                            {
                                changeOrder(i,i-1);
                            }
                        }
                        if(i==2||i==6||i==10||i==14)
                        {
                            if(inFrame.eq(i).html()!=""&&inFrame.eq(i-1).html()=="")
                            {
                                if(inFrame.eq(i-2).html()=="")
                                {
                                    changeOrder(i,i-2)
                                }
                                else {
                                    changeOrder(i,i-1)
                                }
                            }
                            if(inFrame.eq(i).html()!=""&&inFrame.eq(i-1).html()!="")
                            {
                                if(inFrame.eq(i-2).html()=="")
                                {
                                    changeOrder(i,i-1);
                                }
                            }
                        }
                        if(i==3||i==7||i==11|i==15)
                        {
                            if(inFrame.eq(i).html()!=""&&inFrame.eq(i-1).html()=="")
                            {
                                if(inFrame.eq(i-2).html()==""&&inFrame.eq(i-3).html()=="")
                                {
                                    changeOrder(i,i-3);
                                }
                                if(inFrame.eq(i-2).html()==""&&inFrame.eq(i-3).html()!="")
                                {
                                    changeOrder(i,i-2);
                                }
                                if(inFrame.eq(i-2).html()!=""&&inFrame.eq(i-3).html()=="")
                                {
                                    changeOrder(i,i-2);
                                }
                                if(inFrame.eq(i-2).html()!=""&&inFrame.eq(i-3).html()!="")
                                {
                                    changeOrder(i,i-1);
                                }

                            }
                            if(inFrame.eq(i).html()!=""&&inFrame.eq(i-1).html()!="")
                            {
                                if(inFrame.eq(i-2).html()==""&&inFrame.eq(i-3).html()=="")
                                {
                                    changeOrder(i,i-2);
                                }
                                if(inFrame.eq(i-2).html()==""&&inFrame.eq(i-3).html()!="")
                                {
                                    changeOrder(i,i-1);
                                }
                                if(inFrame.eq(i-2).html()!=""&&inFrame.eq(i-3).html()=="")
                                {
                                    changeOrder(i,i-1);
                                }
                            }
                        }
                    }
                    createBox();//随机生成盒子
                }}

                //D事件
            function keyCodeD() {
                if(frag==1)//判断游戏是否开始
                {
                    var inFrame = $(".inFrame");
                    //判断是否有数
                    for(var i=0;i<16;i++)
                    {
                        if(i==2||i==6||i==10||i==14)//第二列
                        {
                            if(inFrame.eq(i).html()!=""&&inFrame.eq(i+1).html()=="")
                            {
                                changeOrder(i,i+1);
                            }
                        }
                        if(i==1||i==5||i==9||i==13)
                        {
                            if(inFrame.eq(i).html()!=""&&inFrame.eq(i+1).html()=="")
                            {
                                if(inFrame.eq(i+2).html()=="")
                                {
                                    changeOrder(i,i+2)
                                }
                                else {
                                    changeOrder(i,i+1)
                                }
                            }
                            if(inFrame.eq(i).html()!=""&&inFrame.eq(i+1).html()!="")
                            {
                                if(inFrame.eq(i+2).html()=="")
                                {
                                    changeOrder(i,i+1);
                                }
                            }
                        }
                        if(i==0||i==4||i==8|i==12)
                        {
                            if(inFrame.eq(i).html()!=""&&inFrame.eq(i+1).html()=="")
                            {
                                if(inFrame.eq(i+2).html()==""&&inFrame.eq(i+3).html()=="")
                                {
                                    changeOrder(i,i+3);
                                }
                                if(inFrame.eq(i+2).html()==""&&inFrame.eq(i+3).html()!="")
                                {
                                    changeOrder(i,i+2);
                                }
                                if(inFrame.eq(i+2).html()!=""&&inFrame.eq(i+3).html()=="")
                                {
                                    changeOrder(i,i+2);
                                }
                                if(inFrame.eq(i+2).html()!=""&&inFrame.eq(i+3).html()!="")
                                {
                                    changeOrder(i,i+1);
                                }

                            }
                            if(inFrame.eq(i).html()!=""&&inFrame.eq(i+1).html()!="")
                            {
                                if(inFrame.eq(i+2).html()==""&&inFrame.eq(i+3).html()=="")
                                {
                                    changeOrder(i,i+2);
                                }
                                if(inFrame.eq(i+2).html()==""&&inFrame.eq(i+3).html()!="")
                                {
                                    changeOrder(i,i+1);
                                }
                                if(inFrame.eq(i+2).html()!=""&&inFrame.eq(i+3).html()=="")
                                {
                                    changeOrder(i,i+1);
                                }
                            }
                        }
                    }
                    createBox();//随机生成盒子
                }}

           document.onkeydown=function (ev) {
               switch (ev.keyCode)
               {
                   case 87:keyCodeW();//w事件
                       break;
                   case 83:keyCodeS();//s事件
                       break;
                   case 65:keyCodeA();//a事件
                       break;
                   case 68:keyCodeD();//d事件
                       break;

               }
           };


        </script>

        <!-- Google Analytics: change UA-XXXXX-Y to be your site's ID. -->
        <script>
            window.ga=function(){ga.q.push(arguments)};ga.q=[];ga.l=+new Date;
            ga('create','UA-XXXXX-Y','auto');ga('send','pageview')
        </script>
        <script src="https://www.google-analytics.com/analytics.js" async defer></script>
    </body>
</html>
